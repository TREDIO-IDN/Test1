<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Harga</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f7f7f7; }
  .topbar { background:white; padding:15px; box-shadow:0 2px 4px rgba(0,0,0,0.1); position:sticky; top:0; z-index:10; }
  .search-box { width:100%; padding:10px; font-size:16px; border:1px solid #ddd; border-radius:8px; }
  .container { padding:15px; }
  table { width:100%; border-collapse:collapse; background:white; border-radius:10px; overflow:hidden; }
  th { background:#ececec; padding:10px; font-size:14px; }
  td { padding:8px; text-align:center; border-bottom:1px solid #eee; }
  input[type="number"] { width:90%; padding:6px; border:1px solid #ccc; border-radius:6px; }
  button { padding:12px 20px; margin-top:20px; width:100%; background:#4CAF50; color:white; border:none; border-radius:8px; font-size:16px; cursor:pointer; }
  button:hover { background:#45a049; }
  @media (max-width:600px) {
    th, td { font-size:13px; }
    input[type="number"] { font-size:14px; }
  }
</style>
</head>
<body>

<div class="topbar">
  <input id="search" class="search-box" placeholder="Cari waktu, contoh: 14:32:00 ..." oninput="filterTable()">
</div>

<div class="container">
  <table id="hargaTable">
    <tr><th>Waktu</th><th>Harga</th></tr>
  </table>

  <button onclick="downloadCSV()">Simpan Perubahan (Export CSV)</button>
</div>

<script>
// MEMUAT DATA HARGA (GENERATE 24 JAM)
const data = [];
for (let h = 0; h < 24; h++) {
  for (let m = 0; m < 60; m++) {
    if (h === 0 && m === 0) continue;
    const hh = String(h).padStart(2,'0');
    const mm = String(m).padStart(2,'0');
    data.push({ waktu:`${hh}:${mm}:00`, harga:75000 });
  }
}

// RENDER TABEL EDITABLE
const table = document.getElementById("hargaTable");
data.forEach(row => {
  const tr = document.createElement("tr");
  tr.innerHTML = `<td>${row.waktu}</td><td><input type='number' value='${row.harga}'></td>`;
  table.appendChild(tr);
});

// SEARCH FILTER
function filterTable() {
  const term = document.getElementById("search").value.toLowerCase();
  const rows = document.querySelectorAll("#hargaTable tr");

  rows.forEach((r, i) => {
    if (i === 0) return;
    const waktu = r.children[0].innerText.toLowerCase();
    r.style.display = waktu.includes(term) ? "" : "none";
  });
}

// EXPORT CSV
function downloadCSV() {
  let csv = `Waktu,Harga
`;
  const rows = document.querySelectorAll("#hargaTable tr");

  rows.forEach((tr, i) => {
    if (i === 0) return;
    const tds = tr.querySelectorAll("td");
    const waktu = tds[0].innerText;
    const harga = tds[1].querySelector("input").value;
    csv += `${waktu},${harga}
`;
  });

  const blob = new Blob([csv], { type: "text/csv" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "harga_updated.csv";
  a.click();
}
</script>
</body>
</html>
